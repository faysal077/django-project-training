{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<h2 class="mb-4 text-center">Dashboard</h2>

<div class="row text-center">
    <div class="col-md-4 mb-3">
        <div class="bg-info text-white p-4 rounded shadow-sm">
            <h3>{{ current_year_trainings|default:"0" }}</h3>
            <p>Trainings This Fiscal Year</p>
        </div>
    </div>
    <div class="col-md-4 mb-3">
        <div class="bg-success text-white p-4 rounded shadow-sm">
            <h3>{{ total_participants|default:"0" }}</h3>
            <p>Total Participants</p>
        </div>
    </div>
    <div class="col-md-4 mb-3">
        <div class="bg-primary text-white p-4 rounded shadow-sm">
            <h3>{{ total_participants_this_year|default:"0" }}</h3>
            <p>Participants This Fiscal Year</p>
        </div>
    </div>
</div>

<div class="row text-center mt-4">
    <div class="col-md-4 mb-3">
        <div class="bg-warning text-white p-4 rounded shadow-sm">
            <h3>{{ total_expenses|default:"0" }}</h3>
            <p>Total Financial Expenses</p>
        </div>
    </div>
    <div class="col-md-4 mb-3">
        <div class="bg-dark text-white p-4 rounded shadow-sm">
            <h3>{{ total_expenses_this_year|default:"0" }}</h3>
            <p>Financial Expenses This Year</p>
        </div>
    </div>
    <div class="col-md-4 mb-3">
        <div class="bg-danger text-white p-4 rounded shadow-sm">
            <h3>{{ total_trainings|default:"0" }}</h3>
            <p>Total Trainings</p>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-lg-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Participant Statistics</h5>
                <div id="participantChart"></div>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Financial Activities</h5>
                <div id="financialChart"></div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // === Participant Chart ===
        const participantChartOptions = {
            chart: { type: 'line', height: 350 },
            series: [
                { name: 'Total', data: {{ participant_total|safe }} },
                { name: 'Male', data: {{ participant_male|safe }} },
                { name: 'Female', data: {{ participant_female|safe }} }
            ],
            xaxis: {
                categories: {{ participant_years|safe }},
                title: { text: "Fiscal Year" }
            },
            yaxis: { title: { text: "Number of Participants" } },
            colors: ['#008FFB', '#00E396', '#FF4560']
        };

        const participantChart = new ApexCharts(document.querySelector("#participantChart"), participantChartOptions);
        participantChart.render();

        // === Financial Chart ===
        const financialChartOptions = {
            chart: { type: 'line', height: 350 },
            series: [
                { name: 'Total Spent', data: {{ financial_spent|safe }} }
            ],
            xaxis: {
                categories: {{ financial_years|safe }},
                title: { text: "Fiscal Year" }
            },
            yaxis: { title: { text: "Amount Spent" } },
            colors: ['#FF9800']
        };

        const financialChart = new ApexCharts(document.querySelector("#financialChart"), financialChartOptions);
        financialChart.render();
    });
</script>
{% endblock %}
